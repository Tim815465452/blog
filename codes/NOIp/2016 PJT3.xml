<?xml-stylesheet type="text/xsl" href="/codes/template.xsl"?>
<page>
	<title>NOIp 2016 PJT3</title>
	<html>
		<center>
			<h2>NOIp 2016 PJT3</h2>
			<var>2017-04-13 16:57 by zsz12251665</var>
		</center>
		<h3>Problem</h3>
		<section>
			<a target="_blank" href="https://www.luogu.org/problem/show?pid=2058">Luogu</a>
			<br/>
			<a target="_blank" href="https://www.vijos.org/p/2011">Vijos</a>
		</section>
		<h3>Solution</h3>
		<section>
			<p>The solution include a queue and a count array. We'll give every passenger an index according to when they appear. For example, the first passenger of the first ship has the first index. The nation array will be used to keep their nationalities. The passenger array will keep the indexes of the first passengers of the ships. Its size is n+1 since the passenger[n+1] will be used to keep the next integer of the index of the last passenger of all. In this way, the indexes of passengers on the i-th arrived ship are from passenger[i] to passenger[i+1]-1. What's more, the time array keeps the arrival times of every ship. The count array is used to keep the numbers of every nationality in the queue. And the queue, I think you have known the purpose, is used to keep the ships that arrived in 86400 seconds from the arrival of the last ship. </p>
			<p>When a new ship has arrived, keep the time of its arrival in the time array. Then add the number of the passengers into the passenger array and add the nationalities to the nation array and the count array. Then check if the head ship of the queue has been out of time. If it has, then remove the nationalities of the passengers on the head ship and check the next ship until the head ship is still in the 86400 seconds. While adding nationalities, don't forget to refresh the answer when you found the count[i] equals zero. After everything has been done, output the answer and wait for the arrival of the next ship. </p>
		</section>
		<h3>Code</h3>
		<section>
			<p>Pascal</p>
			<div class="codebox">
				var<br/>
				&#160;&#160;&#160;&#160;nation:array[1..300000]of longint;<br/>
				&#160;&#160;&#160;&#160;count,passenger:array[1..100001]of longint;<br/>
				&#160;&#160;&#160;&#160;time:array[1..100000]of longint;<br/>
				&#160;&#160;&#160;&#160;n,ans,queue,i,j:longint;<br/>
				begin<br/>
				&#160;&#160;&#160;&#160;ans:=0;<br/>
				&#160;&#160;&#160;&#160;queue:=1;<br/>
				&#160;&#160;&#160;&#160;for i:=1 to 100001 do<strong>//Format the count array</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;count[i]:=0;<br/>
				&#160;&#160;&#160;&#160;passenger[1]:=1;<br/>
				&#160;&#160;&#160;&#160;read(n);<br/>
				&#160;&#160;&#160;&#160;for i:=1 to n do<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;read(time[i],passenger[i+1]);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;passenger[i+1]:=passenger[i]+passenger[i+1];<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for j:=passenger[i] to passenger[i+1]-1 do<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;read(nation[j]);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if count[nation[j]]=0 then<strong>//If there was no one else with this nationality, refresh the answer</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;inc(ans);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;inc(count[nation[j]]);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while time[queue]+86400&lt;=time[i] do<strong>//Check whether the head ship is still in the interval</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for j:=passenger[queue] to passenger[queue+1]-1 do<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;dec(count[nation[j]]);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if count[nation[j]]&lt;=0 then<strong>//If there was no one else with this nationality, refresh the answer</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;dec(ans);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;inc(queue);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;writeln(ans);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end;<br/>
				end.<br/>
			</div>
			<p>C++</p>
			<div class="codebox">
				#include&lt;cstdio&gt;<br/>
				long nation[300000],count[100001],time[100000],passenger[100001];<strong>//The nationalies are from 1 to 100000, so we need a count array with a size of 100001 since the array is started from 0 in C++</strong><br/>
				int main()<br/>
				{<br/>
				&#160;&#160;&#160;&#160;long n,ans=0,queue=0;<br/>
				&#160;&#160;&#160;&#160;for(long i=0;i&lt;100001;i++)<strong>//Format the count array</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;count[i]=0;<br/>
				&#160;&#160;&#160;&#160;passenger[0]=0;<br/>
				&#160;&#160;&#160;&#160;scanf("%ld",&amp;n);<br/>
				&#160;&#160;&#160;&#160;for(long i=0;i&lt;n;i++)<br/>
				&#160;&#160;&#160;&#160;{<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;scanf("%ld%ld",&amp;time[i],&amp;passenger[i+1]);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;passenger[i+1]+=passenger[i];<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for(long j=passenger[i];j&lt;passenger[i+1];j++)<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;scanf("%ld",&amp;nation[j]);<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(count[nation[j]]==0)<strong>//If there was no one else with this nationality, refresh the answer</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ans++;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;count[nation[j]]++;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while(time[queue]+86400&lt;=time[i])<strong>//Check whether the head ship is still in the interval</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;for(long j=passenger[queue];j&lt;passenger[queue+1];j++)<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;count[nation[j]]--;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if(count[nation[j]]&lt;=0)<strong>//If there was no one else with this nationality, refresh the answer</strong><br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ans--;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;queue++;<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>
				&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;printf("%ld\n",ans);<br/>
				&#160;&#160;&#160;&#160;}<br/>
				&#160;&#160;&#160;&#160;return 0;<br/>
				}<br/>
			</div>
		</section>
	</html>
</page>
